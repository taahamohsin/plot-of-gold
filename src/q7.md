Choropleth graph of grouped countries using k means
Interactable scatterplot

<label for="variableSelect"><strong>Select Variable:</strong></label>
<select id="variableSelect">
    <option value="inflation, consumer prices (annual %)">Inflation</option>
    <option value="poverty headcount ratio at $6.85 a day (2017 ppp) (% of population)">Poverty Count</option>
    <option value="literacy rate, adult total (% of people ages 15 and above)">Literacy Rate</option>
    <option value="renewable energy consumption (% of total final energy consumption)">Renewable Energy</option>
    <option value="total greenhouse gas emissions excluding lulucf per capita (t co2e/capita)">Greenhouse Gas Emission</option>
</select>

<div id="my_dataviz"></div>

```js
const socioEco = await FileAttachment("data/socioeconomic_profiles@1.csv").csv(); 
```


```js 
// Scatter plots of GDP vs Factors 
// Chart set up 
    const gdpCol = "gdp per capita (current us$)";
const renewableCol = "renewable energy consumption (% of total final energy consumption)";
const povertyCol = "poverty headcount ratio at $6.85 a day (2017 ppp) (% of population)"; 
const ghgCol = "total greenhouse gas emissions excluding lulucf per capita (t co2e/capita)";
const inflationCol = "inflation, consumer prices (annual %)";
const literacyCol = "literacy rate, adult total (% of people ages 15 and above)"; 

const plotData = socioEco.map(d => ({
    gdp: +d[gdpCol],
    renewable: +d[renewableCol],
    poverty: +d[povertyCol], 
    ghg: +d[ghgCol],
    inflation: +d[inflationCol],
    literacy: +d[literacyCol], 
    country: d["country"],
}));

const varMap = {
    "inflation, consumer prices (annual %)": "inflation",
    "poverty headcount ratio at $6.85 a day (2017 ppp) (% of population)": "poverty",
    "literacy rate, adult total (% of people ages 15 and above)": "literacy",
    "renewable energy consumption (% of total final energy consumption)": "renewable",
    "total greenhouse gas emissions excluding lulucf per capita (t co2e/capita)": "ghg"
};

// Chart setup
const dims = { 
    width: 800, 
    height: 500, 
    margin_top: 60, 
    margin_right: 80, 
    margin_bottom: 60, 
    margin_left: 80 
}; 

// Clear any existing chart in the div
d3.select("#my_dataviz").selectAll("*").remove();

const tooltip = d3.select("body").append("div")
    .style("position", "absolute")
    .style("visibility", "hidden")
    .style("background-color", "white")
    .style("border", "1px solid #333")
    .style("border-radius", "5px")
    .style("padding", "5px")
    .style("font-size", "12px")
    .style("pointer-events", "none") 
    .style("box-shadow", "2px 2px 6px rgba(0,0,0,0.2)");

const svg = d3.select("#my_dataviz")
    .append("svg")
    .attr('width', dims.width + dims.margin_right + dims.margin_left) 
    .attr('height', dims.height + dims.margin_top + dims.margin_bottom); 

const chart = svg.append('g') 
    .attr('transform', `translate(${dims.margin_left}, ${dims.margin_top})`); 

// Scales & Axes
const x_scale = d3.scaleLog()
    .domain(d3.extent(plotData, d => d.gdp))
    .range([0, dims.width])
    .nice();

// Y scale
let y_scale = d3.scaleLinear() 
    .domain(d3.extent(plotData, d => d.renewable))
    .range([dims.height, 0])
    .nice();

// X axis
chart.append("g")
    .attr("transform", `translate(0, ${dims.height})`)
    .call(d3.axisBottom(x_scale).ticks(5, ".1s")); 

// Y axis
const yAxis = chart.append("g")
    .attr("class", "y-axis")
    .call(d3.axisLeft(y_scale));

// X label
chart.append("text")
    .attr("x", dims.width / 2)
    .attr("y", dims.height + 40)
    .attr("text-anchor", "middle")
    .text("GDP Per Capita (Log Scale)");

// Y label (Dynamic)
const yLabel = chart.append("text")
    .attr("transform", "rotate(-90)")
    .attr("x", -dims.height / 2)
    .attr("y", -50)
    .attr("text-anchor", "middle")
    .text("Renewable Energy");

// Adding data
const circles = chart.selectAll('circle')
    .data(plotData)
    .enter()
    .append('circle')
    .attr("cx", d => x_scale(d.gdp) || -1000) 
    .attr("cy", d => y_scale(d.renewable) || -1000)
    .attr("r", 6)
    .style("fill", "#69b3a2")
    .style("opacity", 0.7)
    .style("stroke", "white");

// UPDATE FUNC
function updateChart(selectedOption) {
    const key = varMap[selectedOption];
    
    // Filter for any missing data 
    const validData = plotData.filter(d => !isNaN(d[key]));

    // Update y scale domain
    y_scale.domain(d3.extent(validData, d => d[key])).nice();

    // Animate y axis
    yAxis.transition().duration(1000).call(d3.axisLeft(y_scale));

    // Animate circles
    circles.transition().duration(1000)
        .attr("cy", d => {
            const val = d[key];
            return isNaN(val) ? -1000 : y_scale(val);
        });

    // Update y label
    yLabel.text(selectedOption.split("(")[0]); 
}

// Interaction
d3.select("#variableSelect").on("change", function(event) {
    const selectedOption = d3.select(this).property("value");
    updateChart(selectedOption);
});

updateChart(d3.select("#variableSelect").property("value"));
display(svg.node());
``` 

This is a graph of GDP versus a selected variable. The available variables are poverty headcount, literacy rate, renewable energy use, greenhouse gas emissions, and inflation. From the graphs between GDP vs Poverty and GDP vs Renewable Energy Use, we can visually see groups that start to form. In the GDP vs Poverty graph, we can see groups at the top left, middle, and bottom. In the GDP vs Renewable Energy Use graph, we can still see the same groups in the top left, middle, and bottom to bottom right. This suggests that there is a trade off between using renewable energy and improving the economy. Additionally, this proves that just because a country is successful with a high GDP, it doesn't necessarily mean that the country will have a positive environmental impact. 