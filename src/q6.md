```js
const gapCsv = await FileAttachment("data/education_health_gap_data.csv").csv(); 
```

```js 

// Chart Set Up
  const dims = {
    width: 810,   
    height: 620,  
    margin_top: 60,
    margin_right: 150,
    margin_bottom: 60,
    margin_left: 80
  };

  const innerWidth = dims.width - dims.margin_left - dims.margin_right;
  const innerHeight = dims.height - dims.margin_top - dims.margin_bottom;

  const svg = d3.create('svg')
    .attr('width', dims.width)
    .attr('height', dims.height);

  const chart = svg.append('g')
    .attr('transform', `translate(${dims.margin_left}, ${dims.margin_top})`);
    
  // Groups
  const highIncomeCountries = new Set([
    "USA", "DEU", "JPN", "GBR", "CAN", "FRA", "AUS", "NOR", "SWE"
  ]);

  const developingCountries = new Set([
    "BRA", "RUS", "IND", "CHN", "ZAF",
    "NGA", "PAK", "BGD", "MEX", "IDN", "ETH", "EGY"
  ]);

  function assignGroup(country) {
    if (highIncomeCountries.has(country)) {
      return "High-Income";
    }
    if (developingCountries.has(country)) {
      return "Developing";
    }
    return null;
  }

  const metricCol = "primary completion rate, total (% of relevant age group)";
  
  const processedData = gapCsv.map(d => ({
    year: d3.timeParse("%Y")(d.year), 
    group: assignGroup(d.country),
    value: +d[metricCol]
  })).filter(d => 
    d.group && !isNaN(d.value) && d.year
  );
  
  const avgData = d3.rollup(
    processedData,
    v => d3.mean(v, d => d.value), 
    d => d.year,                   
    d => d.group                 
  );
  
  const flatData = [];
  for (const [year, groups] of avgData) {
    for (const [group, value] of groups) {
      flatData.push({ year, group, value });
    }
  }

  // Scales
  const x_scale = d3.scaleTime()
    .domain(d3.extent(flatData, d => d.year))
    .range([0, innerWidth])
    .nice();

  const y_scale = d3.scaleLinear()
    .domain([0, 100])
    .range([innerHeight, 0])
    .nice();
    
  const colorScale = d3.scaleOrdinal()
    .domain(["High-Income", "Developing"])
    .range(d3.schemeTableau10); 

  // Axes
  chart.append("g")
    .attr("transform", `translate(0, ${innerHeight})`)
    .call(d3.axisBottom(x_scale));

  chart.append("g")
    .call(d3.axisLeft(y_scale).ticks(10, "%")); 

  // Line ---------------------
  const lineGenerator = d3.line()
    .x(d => x_scale(d.year))
    .y(d => y_scale(d.value))
    .curve(d3.curveMonotoneX); 
    
  const groupedForLines = d3.group(flatData, d => d.group);

  chart.selectAll(".line-path")
    .data(groupedForLines)
    .enter()
    .append("path")
      .attr("class", "line-path")
      .attr("d", d => lineGenerator(d[1].sort((a, b) => a.year - b.year))) // d[1] is the array of data
      .style("fill", "none")
      .style("stroke", d => colorScale(d[0])) // d[0] is the group name
      .style("stroke-width", 3);

  // Legend -----------
  const legend = svg.append("g")
    .attr("transform", `translate(${dims.margin_left + innerWidth + 20}, ${dims.margin_top})`);
    
  colorScale.domain().forEach((group, i) => {
    const legendRow = legend.append("g")
      .attr("transform", `translate(0, ${i * 25})`);
      
    legendRow.append("rect")
      .attr("width", 20)
      .attr("height", 20)
      .attr("fill", colorScale(group));
      
    legendRow.append("text")
      .attr("x", 30)
      .attr("y", 15)
      .text(group);
  });

  // Titles
  svg.append("text")
    .attr("text-anchor", "middle")
    .attr("x", dims.width / 2)
    .attr("y", dims.margin_top / 2)
    .style("font-size", "18px")
    .style("font-weight", "bold")
    .text("Education Gap: High-Income vs. Developing Nations");

  svg.append("text")
    .attr("text-anchor", "middle")
    .attr("x", dims.margin_left + innerWidth / 2)
    .attr("y", dims.height - dims.margin_bottom / 2)
    .text("Year");

  svg.append("text")
    .attr("text-anchor", "middle")
    .attr("transform", "rotate(-90)")
    .attr("y", dims.margin_left / 2)
    .attr("x", -(dims.margin_top + innerHeight / 2))
    .text("Primary Completion Rate (%)");

  display(svg.node());

```

This chart shows the completion rate of primary school education with two lines. The blue line represents the high income countries and orange line represents developing countries. What is shown in the graph is that at one point, the developing countries had a higher primary completion rate than developing countries and later on, they became almost equal. This shows that the gap between developing and high income countries is decreasing and shows the foundations of the education field in developing countries is quickly increasing.